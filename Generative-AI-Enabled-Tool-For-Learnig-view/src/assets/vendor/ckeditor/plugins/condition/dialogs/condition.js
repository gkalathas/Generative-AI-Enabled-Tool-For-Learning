CKEDITOR.dialog.add("conditionDialog",function(k){function d(a){var c=e.getInputElement(),b=e.getValue(),g=c.getId(),g=document.getElementById(g),d=g.selectionStart,f=g.selectionEnd,h=b.substring(0,d),b=b.substring(f,b.length);h||(h="");b||(b="");e.setValue(h+" "+a+" "+b);a=d+a.length+2;c.focus();g.setSelectionRange(a,a)}var e,l;return{title:"Ιδιότητες Συνθήκης",minWidth:500,minHeight:200,contents:[{id:"tab-basic",label:"Basic Settings",elements:[{type:"hbox",widths:["25%","75%"],children:[{type:"html",
html:"Περιγραφή Συνθήκης:"},{type:"text",id:"description",setup:function(a){this.setValue(a.getAttribute("condition-description"))},commit:function(a){a.setAttribute("condition-description",this.getValue().trim())}}]},{type:"hbox",widths:["25%","75%"],children:[{type:"html",html:"Επιλογή Πεδίου Tag:"},{type:"select",id:"field",width:"100% !important",style:"width: 100%",items:[["Επιλέξτε...",""]],onLoad:function(a){if(a=document.getElementById("tagsList")){l=tagsList=JSON.parse(a.value);Array.prototype.sortBy=
function(a){return this.slice(0).sort(function(b,c){return b[a]>c[a]?1:b[a]<c[a]?-1:0})};for(var c in tagsList)tagsList[c]=tagsList[c].sortBy("description");var b=this;for(c in tagsList)tagsList[c].forEach(function(a){b.add("["+c+"] "+a.description,a.name)})}},onChange:function(a){this.getValue()&&d("["+this.getValue()+"]")}}]},{type:"hbox",children:[{type:"html",html:"Τελεστές Συνθήκης:"},{type:"button",id:"btnOpenP",width:"10px",label:"(",onClick:function(){d("(")}},{type:"button",id:"btnCloseP",
width:"10px",label:")",onClick:function(){d(")")}},{type:"button",id:"btnAnd",width:"10px",label:"And",onClick:function(){d("\x26\x26")}},{type:"button",id:"btnOr",width:"10px",label:"Or",onClick:function(){d("||")}},{type:"button",id:"btnNot",width:"10px",label:"Not",onClick:function(){d("!")}},{type:"button",id:"btnEquals",width:"10px",label:"\x3d\x3d",onClick:function(){d("\x3d\x3d")}},{type:"button",id:"btnNotEquals",width:"10px",label:"!\x3d",onClick:function(){d("!\x3d")}},{type:"button",id:"btnLower",
width:"10px",label:"\x3c",onClick:function(){d("\x3c")}},{type:"button",id:"btnLowerEquals",width:"10px",label:"\x3c\x3d",onClick:function(){d("\x3c\x3d")}},{type:"button",id:"btnBigger",width:"10px",label:"\x3e",onClick:function(){d("\x3e")}},{type:"button",id:"btnBiggerEquals",width:"10px",label:"\x3e\x3d",onClick:function(){d("\x3e\x3d")}}]},{type:"textarea",id:"expression",className:"conditionExpression",label:"Συνθήκη",rows:10,"default":"",validate:function(){var a=this.getValue(),c=this.getValue().match(/\[(.*?)\]/g),
b;for(b in c)for(var d in l)if("function"!==typeof c[b]){var e=c[b].substring(1,c[b].length-1),f=l[d].find(function(a){return a.name==e});if(void 0!=f){"STRING"==f.type?a=a.replace(c[b],'"Test"'):"LONG"==f.type?a=a.replace(c[b],"0"):"DATE"==f.type&&(a=a.replace(c[b],"0"));break}}try{eval(a)}catch(h){return alert("Η συνθήκη δεν είναι έγκυρη. Παρακαλώ διορθώστε."),!1}},setup:function(a){e=this;e.setValue(a.getAttribute("condition"))},commit:function(a){a.setAttribute("condition",this.getValue().trim())}}]}],
onOk:function(){var a=this.element;this.commitContent(a);this.insertMode&&k.insertElement(a)},onShow:function(){var a=k.getSelection().getStartElement();a&&(a=a.getAscendant("div",!0));a&&"div"==a.getName()?this.insertMode=!1:(a=k.document.createElement("div"),this.insertMode=!0);this.element=a;this.setupContent(a)}}});